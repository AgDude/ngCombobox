/*! ngCombobox v2.0.1, License: MIT, Generated at 2016-03-16 10:50:52 -0500 */!function(){"use strict";function a(){var a={};return{on:function(b,c){return b.split(" ").forEach(function(b){a[b]||(a[b]=[]),a[b].push(c)}),this},trigger:function(b,c){return angular.forEach(a[b],function(a){a.call(null,c)}),this}}}function b(a,b){return a=a||[],a.length>0&&!angular.isObject(a[0])&&a.forEach(function(c,d){a[d]={},a[d][b]=c}),a}function c(a,b,c){for(var d=null,e=0;e<a.length;e++)if(a[e][c].toLowerCase()===b[c].toLowerCase()){d=a[e];break}return d}function d(a,b,c){var d=b.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");return a.replace(new RegExp(d,"gi"),c)}var e={backspace:8,tab:9,enter:13,escape:27,space:32,up:38,down:40,comma:188,period:190,dot:110},f=angular.module("ngCombobox",[]);f.factory("SuggestionList",["$timeout","$interval","$q","$sce",function(a,d){return function(e,f,g){var h,i,j,k,l,m={};return k=function(a,b){return a.filter(function(a){return!c(b,a,g.displayProperty)})},m.reset=function(){l=null,h=g.debounceDelay,m.items=[],m.visible=!1,m.loading=!1,m.confirm=!1,m.index=-1,m.selected=null,m.query=null,a.cancel(i),d.cancel(j)},m.show=function(){m.selected=null,m.visible=!0,m.loading=!1,m.select(0)},m.msgVisible=function(){return(m.confirm||m.newSaving||m.loading)&&!m.visible},m.loadingFn=function(a){var b=0;j=d(function(){b++;var c=new Array(b%6).join(".");m.msg=a+c},250)},m.load=function(c,n,o,p){return!o&&c.length<g.minSearchLength?void m.reset():(void 0===p&&(p=e),d.cancel(j),m.msg=angular.copy(g.loadingMsg),p===f&&(m.msg=angular.copy(g.secondaryMsg)),a.cancel(i),void(i=a(function(){m.query=c;var d=p({$query:c});m.msg&&(m.loadingFn(m.msg),a(function(){m.loading=!0})),l=d,d.then(function(a){if(d===l){if(a=b(a.data||a,g.displayProperty),a=k(a,n),f&&0===a.length&&p===e)return m.visible=!1,m.load(c,n,o,f);m.more=Math.max(0,a.length-g.maxResultsToShow),m.more>100&&(m.more="many"),m.items=a.slice(0,g.maxResultsToShow)||[],m.items.length>0?m.show():(m.reset(),g.allowNew&&g.confirmNew&&(m.confirm=c+" not found. Click to create it",h=0))}})},h,!1)))},m.selectNext=function(){m.select(++m.index)},m.selectPrior=function(){m.select(--m.index)},m.select=function(a){0>a?a=m.items.length-1:a>=m.items.length&&(a=0),m.index=a,m.selected=m.items[a]},m.reset(),m}}]).factory("encodeHTML",function(){return function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}}).factory("TagList",function(){return function(a,b){var d,e,f,g={};return d=function(b){return b[a.displayProperty]},e=function(b,c){b[a.displayProperty]=c},f=function(b){var e=d(b);return e.length>=a.minLength&&e.length<=(a.maxLength||e.length)&&a.allowedTagsPattern.test(e)&&!c(g.items,b,a.displayProperty)},g.items=[],g.addText=function(a){if(a){var c={};return e(c,a),b.trigger("new-tag-added",c),g.add(c)}},g.add=function(c){var h=d(c);return h=isNaN(h)?h.trim():h.toString(),a.replaceSpacesWithDashes&&(h=h.replace(/\s/g,"-")),e(c,h),f(c)?(g.items.push(c),b.trigger("tag-added",{$tag:c})):b.trigger("invalid-tag",{$tag:c}),c},g.remove=function(a){var c=g.items.splice(a,1)[0];return b.trigger("tag-removed",{$tag:c}),c},g.removeLast=function(){var b,c=g.items.length-1;return a.enableEditingLastTag||g.selected?(g.selected=null,b=g.remove(c)):g.selected||(g.selected=g.items[c]),b},g}}).factory("numberSorter",function(){return function(a,b,c){c=c||"text";var d=parseInt(a[c]),e=parseInt(b[c]);return isNaN(d)||isNaN(e)?isNaN(d)?isNaN(e)?a[c].toLowerCase()>b[c].toLowerCase()?1:a[c].toLowerCase()<b[c].toLowerCase()?-1:0:1:-1:d-e}}).factory("matchSorter",["numberSorter",function(a){return function(b,c){return c=void 0===c?"text":c,b?function(d,e){if(0===d[c].toLowerCase().indexOf(b)||0===e[c].toLowerCase().indexOf(b)){var f=d[c].toLowerCase().indexOf(b)-e[c].toLowerCase().indexOf(b);return 0===f?a(d,e,c):f}return 0}:function(b,d){return a(b,d,c)}}}]).factory("grep",function(){return function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e}}).factory("escapeRegExp",function(){return function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}}).factory("isUndefined",function(){return function(a,b){return angular.isUndefined(a)||null===a?!0:a instanceof Array&&1===a.length&&angular.isUndefined(a[0])?!0:b&&a instanceof Array&&0===a.length?!0:!1}}),f.directive("combobox",["$timeout","$document","$sce","$q","grep","SuggestionList","TagList","encodeHTML","tagsInputConfig","matchSorter","isUndefined","escapeRegExp",function(c,f,g,h,i,j,k,l,m,n,o,p){return{restrict:"E",require:["ngModel","?timepicker","^?form"],scope:{tags:"=ngModel",inputValue:"=?value",onTagAdded:"&",onTagRemoved:"&",newTagAdded:"=?",source:"=?",secondarySource:"=?",valueLookup:"=?",sortFunc:"=?"},replace:!1,transclude:!0,templateUrl:"ngCombobox/combobox.html",controller:["$scope","$attrs","$element",function(b,c){m.load("ngCombobox",b,c,{placeholder:[String,""],disabledPlaceholder:[String,""],tabindex:[Number],removeTagSymbol:[String,String.fromCharCode(215)],removeButton:[Boolean,!0],replaceSpacesWithDashes:[Boolean,!0],minLength:[Number,1],maxLength:[Number],showTotal:[Boolean,!0],addOnEnter:[Boolean,!0],addOnTab:[Boolean,!0],addOnSpace:[Boolean,!1],addOnComma:[Boolean,!0],addOnPeriod:[Boolean,!0],addOnBlur:[Boolean,!0],allowedTagsPattern:[RegExp,/.+/],enableEditingLastTag:[Boolean,!1],minTags:[Number,0],maxTags:[Number,999],displayProperty:[String,"text"],valueProperty:[String,"value"],allowLeftoverText:[Boolean,!1],allowNew:[Boolean,!1],confirmNew:[Boolean,!0],showAll:[Boolean,!0],debounceDelay:[Number,100],minSearchLength:[Number,3],highlightMatchedText:[Boolean,!0],maxResultsToShow:[Number,10],loadingMsg:[String,""],secondaryMsg:[String,""],savingMsg:[String,""],autofocus:[Boolean,!1]}),b.events=new a,b.tagList=new k(b.options,b.events),b.removeTag=function(a){b.isDisabled()||b.tagList.remove(a)}}],link:{post:function(a,k,m,q){function r(b){return function(c){var d=c.$query.toLowerCase(),e=new RegExp(p(d),"i"),f=h.defer(),g=i(a[b],function(a){return e.test(a[A.displayProperty])}),j=a.sortFunc||n;return g.sort(j(d,A.displayProperty)),f.resolve(g),f.promise}}var s,t,u,v,w,x,y,z=[e.enter,e.tab,e.escape,e.up,e.down,e.dot,e.period,e.space,e.comma,e.backspace],A=a.options,B=q[0],C=q[1],D=a.events,E=k.find("input"),F=k.find("option"),G={};if(A.autofocus&&E.attr("autofocus",!0),G[" "]=A.addOnSpace?e.space:void 0,G[","]=A.addOnComma?e.comma:void 0,G["."]=A.addOnPeriod?e.period:void 0,A.currentPlaceholder=A.placeholder,B.$isEmpty=function(a){return angular.isUndefined(a)||""===a||null===a||a!==a||0===a.length},void 0!==C&&null!==C?(a.source=C.timeMatcher,a.newTagAdded=C.timeValidator,x=C.fromValue,m.hasOwnProperty("show-total")||(a.options.showTotal=!1),m.hasOwnProperty("allowNew")||(a.options.allowNew=!0),a.options.minSearchLength=1,a.options.confirmNew=!1,a.options.addOnPeriod=!1,a.options.replaceSpacesWithDashes=!1):x=a.valueLookup,F.length>0){var H=[],I=[];B.$isEmpty()||(H=B.$viewValue),angular.forEach(F,function(a){var b={};b[A.valueProperty]=a.value,b[A.displayProperty]=a.label||angular.element(a).text(),I.push(b),a.hasAttribute("selected")&&H.push(b),angular.element(a).remove()}),a.source=I,B.$setViewValue(H),B.$setPristine(),angular.isUndefined(q[2])||angular.isUndefined(q[2].initial_data)||(q[2].initial_data[m.name]=angular.copy(B.$modelValue))}else angular.isUndefined(a.source)&&(a.source=[]);a.isDisabled=function(){return angular.isDefined(m.disabled)&&m.disabled!==!1?(A.disabledPlaceholder&&(A.currentPlaceholder=A.disabledPlaceholder),!0):!1},D.on("tag-added",a.onTagAdded).on("tag-removed",a.onTagRemoved).on("tag-added",function(){a.newTag.text=""}).on("tag-added tag-removed",function(){B.$setViewValue(a.tags),a.$parent.$eval(m.ngChange)}).on("tag-added invalid-tag",function(){s.reset()}).on("invalid-tag",function(){a.newTag.invalid=!0}).on("input-change",function(b){a.tagList.selected=null,a.newTag.invalid=null,b?s.load(b,a.tags):s.reset()}).on("input-focus",function(){B.$setValidity("leftoverText",!0)}).on("input-blur",function(){A.allowNew&&!A.confirmNew&&(A.addOnBlur&&a.tagList.addText(a.newTag.text),B.$setValidity("leftoverText",A.allowLeftoverText?!0:!a.newTag.text))}).on("new-tag-added",function(b){void 0!==a.newTagAdded&&(s.confirm=!1,A.savingMsg&&(s.newSaving=!0),a.newTagAdded(b).then(function(a){if(void 0!==a&&a.hasOwnProperty("data"))for(var c in a.data)b[c]=a.data[c]})["catch"](function(){a.tagList.items.pop()})["finally"](function(){s.newSaving=!1}))}),a.newTag={text:"",invalid:null,readonly:!1},y=function(b){var c=h.defer();return c.promise.then(function(a){var c=[],d=B.$viewValue;d instanceof Array&&angular.forEach(d,function(a){a!==b&&c.push(a)}),angular.forEach(a,function(a){c.push(a)}),c=c.filter(function(a,b,c){return c.map(function(a){return a[A.valueProperty]}).indexOf(a[A.valueProperty])===b}),B.$setViewValue(c),B.$setPristine()}),o(b,!0)?(c.resolve([]),c.promise):b.hasOwnProperty("fromValue")&&(b=b.fromValue,o(b,!0))?(c.resolve([]),c.promise):(o(x)?c.resolve(a.source instanceof Array?a.source.filter(function(a){var c=a[A.valueProperty];return!angular.isUndefined(c)&&c.toString()===b.toString()}):[]):x(b).then(function(a){c.resolve(a)}),c.promise)},a.getDisplayText=function(a){return angular.isUndefined(a)?"":a[A.displayProperty].trim()},a.addNewTag=function(){a.tagList.addText(a.newTag.text)},a.track=function(a){return a[A.displayProperty]},a.newTagChange=function(){D.trigger("input-change",a.newTag.text)},a.$watch("tags",function(c){if(void 0===c||null===c||c.length>0&&void 0===c[0])a.tags=[];else{if(c instanceof Object&&c.hasOwnProperty("fromValue"))return y(c.fromValue);a.tags=b(c,A.displayProperty)}a.tagList.items=a.tags}),a.$watch("tags.length",function(b){a.newTag.readonly=b>=A.maxTags,B.$setValidity("maxTags",angular.isUndefined(A.maxTags)||b<=A.maxTags),B.$setValidity("minTags",angular.isUndefined(A.minTags)||b>=A.minTags)}),v="function"==typeof a.source?a.source:r("source"),"function"==typeof a.secondarySource?w=a.secondarySource:void 0!==a.secondarySource&&(w=r("secondarySource")),s=new j(v,w,A),a.suggestionList=s,t=function(a){return a[A.displayProperty]},a.toggleSuggestionList=function(){s.visible?s.reset():a.isDisabled()||s.load(a.newTag.text,a.tags,!0)},a.addSuggestion=function(){var b=!1;return a.tags.length>=a.options.maxTags&&a.tags.pop(),s.selected&&(a.tagList.add(s.selected),s.reset(),E[0].focus(),b=!0),b},a.highlight=function(a){var b=t(a);return b=l(b),A.highlightMatchedText&&(b=d(b,l(s.query),"<em>$&</em>")),g.trustAsHtml(b)},a.track=function(a){return t(a)};var J={};if(J[e.enter]=A.addOnEnter,J[e.tab]=A.addOnTab,J[e.comma]=A.addOnComma,J[e.space]=A.addOnSpace,J[e.period]=A.addOnPeriod,J[e.dot]=A.addOnPeriod,a.addKeys=J,E.on("keydown",function(b){var d,f,g,h=b.keyCode,i=b.shiftKey||b.altKey||b.ctrlKey||b.metaKey,j=!1;if(0===h&&(h=G[a.newTag.text.slice(-1)]),!i&&-1!==z.indexOf(h)){if(s.visible?h===e.down?(s.selectNext(),j=!0):h===e.up?(s.selectPrior(),j=!0):h===e.escape?(s.reset(),j=!0):a.addKeys[h]&&(j=a.addSuggestion()):h===e.down&&(a.toggleSuggestionList(),j=!0),d=A.allowNew&&J[h]&&!A.confirmNew,f=!d&&h===e.backspace&&0===a.newTag.text.length,g=!A.allowNew&&a.newTag.invalid&&J[h],d)a.tagList.addText(a.newTag.text),j=!0;else if(f){var k=a.tagList.removeLast();k&&A.enableEditingLastTag&&(a.newTag.text=k[A.displayProperty]),j=!0}else g&&(a.newTag.text="Invalid Entry...",a.newTag.readonly=!0,a.$apply(),c(function(){a.newTag.text="",a.newTag.readonly=!1},2e3));j&&(h!==e.tab&&(b.preventDefault(),b.stopPropagation()),a.$apply())}}).on("focus",function(){a.hasFocus||c(function(){a.hasFocus=!0,D.trigger("input-focus")})}).on("blur",function(){c(function(){var b=f.prop("activeElement"),c=b===E[0],d=k[0].contains(b);(c||!d)&&(a.hasFocus=!1,s.reset(),D.trigger("input-blur"))})}),k.find("div").on("click",function(){E[0].focus()}),void 0!==a.inputValue){var K,L=a.inputValue;if(L instanceof Array||(L=[L]),K=function(){for(var b=0;b<L.length;b++)y(L[b])||(a.newTag.text=L[b],a.addNewTag(),a.newTag.text="")},0===a.source.length){var M;A.currentPlaceholder="Loading Initial Data...",M=a.$watch("source",function(a){a.length>0&&(K(),M())})}K(),k.removeAttr("value")}if(!(a.tags instanceof Array)&&void 0!==a.tags){if(a.tags instanceof Object&&a.tags.hasOwnProperty("fromValue"))return y(a.tags);y(a.tags)}u=function(){s.visible&&(s.reset(),a.$apply())},f.on("click",u),a.$on("$destroy",function(){f.off("click",u)})}}}}]),f.factory("timeValidator",function(){return function(a){var b,c,d,e,f=a.text.replace(/\D/g,""),g=a.text.match(/[apAP+]/);return g="p"===g||"P"===g||"+"===g?"PM":"AM",b=3===f.length?f.substr(0,1):f.substr(0,2),c=3===f.length?f.substr(1,2):f.substr(2,2),parseInt(b)>12?(b=parseInt(b)-12,g="PM"):0===parseInt(b)&&(b=12,g="AM"),d=b+":"+c+" "+g,/(^[0-9]|[0-1][0-9]|[2][0-4]):([0-5][0-9])\s?(AM|PM)?$/.test(d)?(e="PM"===g?parseInt(b)+12:b,"AM"===g&&"12"===e&&(e="00"),e+=":"+c,{text:d,value:e}):{}}}).directive("timepicker",["timeValidator","escapeRegExp",function(a,b){return{restrict:"A",require:"combobox",priority:10,controller:["$scope","$q","grep","matchSorter",function(c,d,e,f){for(var g,h,i,j=[],k=this,l=0;24>l;l++){h=12>=l&&l>0?l.toString():0===l?"12":(l-12).toString();for(var m=0;60>m;m+=15)g=l>=12?" PM":" AM",i=10>m?"0"+m:m.toString(),j.push({text:h+":"+i+g,value:l.toString()+":"+i,raw:h+i+g})}this.timeMatcher=function(a){var c,g,h=a.$query.toLowerCase(),i=h.replace(/[\D]/g,""),k=h.match(/[apAP\+]/),l=new RegExp(b(i),"i"),m=d.defer();return null==k?k="":"+"===k&&(k="P"),g=new RegExp(k,"i"),c=e(j,function(a){return l.test(a.raw)}),c=e(c,function(a){return g.test(a.raw)}),c.sort(f(i)),m.resolve(c),m.promise},this.timeValidator=function(b){var c=d.defer();return c.resolve({data:a(b)}),c.promise},this.fromValue=function(a){var b=d.defer();return k.timeValidator({text:a}).then(function(a){b.resolve([a.data])}),b.promise}}]}}]),f.directive("tiTranscludePrepend",function(){return function(a,b,c,d,e){e(function(a){b.prepend(a)})}}),f.provider("tagsInputConfig",function(){var a={},b={};this.setDefaults=function(b,c){return a[b]=c,this},this.setActiveInterpolation=function(a,c){return b[a]=c,this},this.$get=["$interpolate",function(c){var d={};return d[String]=function(a){return a},d[Number]=function(a){return parseInt(a,10)},d[Boolean]=function(a){return"true"===a.toLowerCase()},d[RegExp]=function(a){return new RegExp(a)},{load:function(e,f,g,h){f.options={},angular.forEach(h,function(h,i){var j,k,l,m,n;j=h[0],k=h[1],l=d[j],m=function(){var b=a[e]&&a[e][i];return angular.isDefined(b)?b:k},n=function(a){f.options[i]=a?l(a):m()},b[e]&&b[e][i]?g.$observe(i,function(a){n(a)}):n(g[i]&&c(g[i])(f.$parent))})}}}]}),f.run(["$templateCache",function(a){a.put("ngCombobox/combobox.html",'<div class="host" ng-class="{\'input-group\': options.showAll }" tabindex="-1" ti-transclude-prepend=""><div class="tags" ng-class="{\'focused\': hasFocus, \'disabled\':isDisabled()}"><ul class="tag-list"><li class="tag-item" ng-repeat="tag in tagList.items track by $id(tag)" ng-class="{ selected: tag == tagList.selected }"><span>{{getDisplayText(tag)}}</span> <a class="remove-button" ng-click="removeTag($index)" ng-if="options.removeButton">{{options.removeTagSymbol}}</a></li></ul><input class="input" placeholder="{{tags.length < options.maxTags && options.currentPlaceholder || \'\' }}" tabindex="{{options.tabindex}}" ng-model="newTag.text" ng-readonly="newTag.readonly" ng-change="newTagChange()" ng-trim="false" ng-class="{\'invalid-tag\': newTag.invalid, \'input-narrow\' : tags.length >= options.maxTags}" ng-disabled="isDisabled()" ti-autosize=""></div><div><div class="autocomplete clearfix" ng-show="suggestionList.visible || suggestionList.msgVisible()"><!-- Messages --><ul class="suggestion-list" ng-hide="suggestionList.visible"><li class="suggestion-item" ng-click="addNewTag()" ng-show="suggestionList.confirm">{{ suggestionList.confirm }}</li><li class="suggestion-item" ng-show="suggestionList.newSaving">{{ options.savingMsg }}</li><li class="suggestion-item" ng-show="suggestionList.loading && !suggestionList.confirm">{{ suggestionList.msg }}</li></ul><!-- Actual Suggestions --><ul class="suggestion-list" ng-show="suggestionList.visible"><li class="suggestion-item" ng-repeat="item in suggestionList.items track by $id(item)" ng-class="{selected: item == suggestionList.selected}" ng-click="addSuggestion()" ng-mouseenter="suggestionList.select($index)" ng-bind-html="highlight(item)"></li><li class="suggestion-item" ng-show="options.showTotal && suggestionList.more">... and {{ suggestionList.more }} more</li></ul></div></div><span class="input-group-addon" ng-if="options.showAll" ng-click="toggleSuggestionList(); $event.stopPropagation();"><span class="ui-button-icon-primary ui-icon ui-icon-triangle-1-s"><span class="ui-button-text" style="padding: 0px">&nbsp;</span></span></span></div>')}])}();